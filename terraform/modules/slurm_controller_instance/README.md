# Module: Slurm Controller Instance

[FAQ](../../../docs/faq.md) | [Glossary](../../../docs/glossary.md)

<!-- mdformat-toc start --slug=github --no-anchors --maxlevel=6 --minlevel=1 -->

- [Module: Slurm Controller Instance](#module-slurm-controller-instance)
  - [Overview](#overview)
  - [Usage](#usage)
  - [Dependencies](#dependencies)
  - [Module API](#module-api)

<!-- mdformat-toc end -->

## Overview

This is a submodule of [slurm_cluster](../slurm_cluster/). This module creates a
Slurm controller instance from
[instance template](../../../docs/glossary.md#instance-template). Certain
properties from the
[instance template](../../../docs/glossary.md#instance-template) will be
overridden when instanceated as a [VM](../../../docs/glossary.md#vm).

It is recommended to pass in an
[instance template](../../../docs/glossary.md#instance-template) generated by
the [slurm_instance_template](../slurm_instance_template) module.

The controller is responisble for managing compute instances defined by multiple
[slurm_partition](../slurm_partition/README.md).

The controller instance run [slurmctld](../../../docs/glossary.md#slurmctld),
[slurmdbd](../../../docs/glossary.md#slurmdbd), and
[slurmrestd](../../../docs/glossary.md#slurmrestd).

## Usage

See [examples](../../examples/slurm_controller_instance/) directory for sample
usages.

See below for a simple inclusion within your own terraform project.

```hcl
module "slurm_controller_instance" {
  source = "git::https://github.com/SchedMD/slurm-gcp//terraform/modules/slurm_controller_instance?ref=v5.0.0"

  project_id = "<PROJECT_ID>"

  region     = "us-central1"
  subnetwork = "default"

  instance_template = "<INSTANCE_TEMPLATE>"

  slurm_cluster_name = "<SLURM_CLUSTER_NAME>"
  slurm_cluster_id   = "<SLURM_CLUSTER_ID>"
}
```

> **NOTE:** Because this module is not hosted on
> [Terraform Registry](../../../docs/glossary.md#terraform-registry), the
> version must be strictly controlled via
> [revision](https://www.terraform.io/language/modules/sources#selecting-a-revision)
> syntax on the source line.

## Dependencies

Please review the dependencies and requirements of the following items:

- [Terraform](https://www.terraform.io/downloads.html) is installed.
- [GCP Cloud SDK](https://cloud.google.com/sdk/downloads) is installed.
- [Compute Engine](../../../docs/glossary.md#compute-engine) is enabled.
- [Secret Manager](../../../docs/glossary.md#secret-manager) is enabled.
- [Python](../../../docs/glossary.md#python) is installed.
  - Required Version: `>= 3.6.0, < 4.0.0`
- [Pip](../../../../../docs/glossary.md#pip) packages are installed.
  - `pip3 install -r ../../../scripts/requirements.txt --user`

## Module API

For the terraform module API reference, please see
[README_TF.md](./README_TF.md).
